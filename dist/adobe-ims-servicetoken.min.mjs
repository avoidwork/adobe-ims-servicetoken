/*!
 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 2.0.4
*/
import e from"form-data";import t from"node-fetch";import o from"murmurhash3js";const n=o.x64.hash128,r=new Map,s="function"==typeof structuredClone?structuredClone:e=>JSON.parse(JSON.stringify(e)),a="undefined"!=typeof FormData?FormData:e,i="undefined"!=typeof fetch?fetch:t;module.exports=async function({url:e="https://ims-na1.adobelogin.com/ims/token",grant_type:t="authorization_code",client_id:o="",client_secret:c="",code:d="",jwt_token:p=""}={}){const m=n(`${e}|${o}|${t}`);let u;if(!1===r.has(m)){const n=new a;let f;t.length>0&&n.append("grant_type",t),n.append("client_id",o),n.append("client_secret",c),d.length>0&&n.append("code",d),p.length>0&&n.append("jwt_token",p);try{f=await i(e,{method:"POST",headers:n.getHeaders(),body:n})}catch(e){f={ok:!1,statusText:e.message||e,json:async()=>({error:f.statusText,error_description:e.message}),text:async()=>e.message||e}}const h=await f.json();if(!f.ok)throw new Error(`[${f.status}] ${h.error}: ${h.error_description}`);r.set(m,h.access_token),u=s(h.access_token),void 0!==h.expires_in&&setTimeout((()=>r.delete(m)),h.expires_in)}else u=s(r.get(m));return u};//# sourceMappingURL=adobe-ims-servicetoken.min.mjs.map
