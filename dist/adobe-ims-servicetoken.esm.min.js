/*!
 2022 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 2.0.0
*/
import e from"form-data";import t from"murmurhash3js";const s=t.x64.hash128,n=new Map,o="function"==typeof structuredClone?structuredClone:e=>JSON.parse(JSON.stringify(e));module.exports=async function({url:t="https://ims-na1.adobelogin.com/ims/token",grant_type:r="authorization_code",client_id:a="",client_secret:i="",code:c="",jwt_token:d=""}={}){const p=s(`${t}|${a}|${r}`);let l;if(!1===n.has(p)){const s=new e;let m;r.length>0&&s.append("grant_type",r),s.append("client_id",a),s.append("client_secret",i),c.length>0&&s.append("code",c),d.length>0&&s.append("jwt_token",d);try{m=await fetch(t,{method:"POST",headers:s.getHeaders(),body:s})}catch(e){m={ok:!1,statusText:e.message||e,json:async()=>({error:m.statusText,error_description:e.message}),text:async()=>e.message||e}}const u=await m.json();if(!m.ok)throw new Error(`[${m.status}] ${u.error}: ${u.error_description}`);n.set(p,u.access_token),l=o(u.access_token),void 0!==u.expires_in&&setTimeout((()=>n.delete(p)),u.expires_in)}else l=o(n.get(p));return l};//# sourceMappingURL=adobe-ims-servicetoken.esm.min.js.map
