/*!
 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 3.0.0
*/
import e from"murmurhash3js";const t=e.x64.hash128,n=new Map,s="function"==typeof structuredClone?structuredClone:e=>JSON.parse(JSON.stringify(e));module.exports=async function({url:e="https://ims-na1.adobelogin.com/ims/token",grant_type:o="authorization_code",client_id:r="",client_secret:a="",code:c="",jwt_token:i=""}={}){const p=t(`${e}|${r}|${o}`);let d;if(!1===n.has(p)){const t=new FormData;let l;o.length>0&&t.append("grant_type",o),t.append("client_id",r),t.append("client_secret",a),c.length>0&&t.append("code",c),i.length>0&&t.append("jwt_token",i);try{l=await fetch(e,{method:"POST",body:t})}catch(e){l={ok:!1,statusText:e.message||e,json:async()=>({error:l.statusText,error_description:e.message}),text:async()=>e.message||e}}const u=await l.json();if(!l.ok)throw new Error(`[${l.status}] ${u.error}: ${u.error_description}`);n.set(p,u.access_token),d=s(u.access_token),void 0!==u.expires_in&&setTimeout((()=>n.delete(p)),u.expires_in)}else d=s(n.get(p));return d};//# sourceMappingURL=adobe-ims-servicetoken.esm.min.js.map
