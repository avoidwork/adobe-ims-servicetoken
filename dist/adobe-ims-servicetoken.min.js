/*!
 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 3.0.2
*/
import e from"murmurhash3js";import t from"form-data";const s=e.x64.hash128,n=new Map;async function o({url:e="https://ims-na1.adobelogin.com/ims/token",grant_type:o="authorization_code",client_id:r="",client_secret:a="",code:c="",jwt_token:i=""}={}){const d=s(`${e}|${r}|${o}`);let p;if(!1===n.has(d)){const s=new t;let l;o.length>0&&s.append("grant_type",o),s.append("client_id",r),s.append("client_secret",a),c.length>0&&s.append("code",c),i.length>0&&s.append("jwt_token",i);try{l=await fetch(e,{method:"POST",headers:s.getHeaders(),body:s})}catch(e){l={ok:!1,statusText:e.message||e,json:async()=>({error:l.statusText,error_description:e.message}),text:async()=>e.message||e}}const h=l.ok?await l.clone().json():await l.clone().text();if(!l.ok){const e="string"==typeof h?l.statusText:`${h?.error}: ${h?.error_description}`;throw new Error(`[${l.status}] ${e}`)}n.set(d,h.access_token),p=structuredClone(h.access_token),void 0!==h.expires_in&&setTimeout((()=>n.delete(d)),h.expires_in)}else p=structuredClone(n.get(d));return p}export{o as token};//# sourceMappingURL=adobe-ims-servicetoken.min.js.map
