/*!
 2023 Jason Mulligan <jason.mulligan@avoidwork.com>
 @version 2.0.5
*/
import e from"form-data";import t from"node-fetch";import n from"murmurhash3js";const o=n.x64.hash128,r=new Map,s="function"==typeof structuredClone?structuredClone:e=>JSON.parse(JSON.stringify(e)),a="undefined"!=typeof FormData?FormData:e,i="undefined"!=typeof fetch?fetch:t;async function c({url:e="https://ims-na1.adobelogin.com/ims/token",grant_type:t="authorization_code",client_id:n="",client_secret:c="",code:d="",jwt_token:p=""}={}){const m=o(`${e}|${n}|${t}`);let f;if(!1===r.has(m)){const o=new a;let h;t.length>0&&o.append("grant_type",t),o.append("client_id",n),o.append("client_secret",c),d.length>0&&o.append("code",d),p.length>0&&o.append("jwt_token",p);try{h=await i(e,{method:"POST",headers:o.getHeaders(),body:o})}catch(e){h={ok:!1,statusText:e.message||e,json:async()=>({error:h.statusText,error_description:e.message}),text:async()=>e.message||e}}const u=await h.json();if(!h.ok)throw new Error(`[${h.status}] ${u.error}: ${u.error_description}`);r.set(m,u.access_token),f=s(u.access_token),void 0!==u.expires_in&&setTimeout((()=>r.delete(m)),u.expires_in)}else f=s(r.get(m));return f}export{c as token};//# sourceMappingURL=adobe-ims-servicetoken.min.js.map
